{"version":3,"sources":["../../cli-astro-commands/src/bi-app/useWixCliAppBi.ts","../../cli-astro-commands/src/bi-app/events.ts","../../cli-astro-commands/src/bi-app/index.ts"],"sourcesContent":["import { useMemo } from 'react';\nimport { useBiLogger } from '@wix/cli-telemetry-react';\nimport { wixCliAppBiEvents } from './events.js';\n\nexport function useWixCliAppBi() {\n  const biLogger = useBiLogger();\n  return useMemo(() => wixCliAppBiEvents(biLogger), [biLogger]);\n}\n","import {\n  wixCliAction,\n  wixCliAppFlowStepsAnswers,\n  wixCliAppFlowFileUploadStarted,\n  wixCliAppFlowUploadEnded,\n  wixCliAppsFlowDeploymentStatusSrc11Evid5232,\n} from '@wix/bi-logger-dev-tools-data/v2';\nimport type { BiLogger } from '@wix/cli-telemetry';\n\nexport const wixCliAppBiEvents = (biLogger: BiLogger) => ({\n  cliAction: ({\n    questionKey,\n    question,\n    action,\n    key,\n    additionalInfo,\n  }: {\n    questionKey: string;\n    question: string;\n    action: string;\n    key: string;\n    additionalInfo?: Record<string, unknown>;\n  }) => {\n    void biLogger.report(\n      wixCliAction({\n        questionKey,\n        question,\n        action,\n        key,\n        additionalInfo: JSON.stringify(additionalInfo),\n      })\n    );\n  },\n  cliStepBack: ({\n    additionalInfo,\n  }: {\n    additionalInfo?: Record<string, unknown>;\n  }) => {\n    void biLogger.report(\n      wixCliAction({\n        action: 'goToPreviousStep',\n        key: 'Esc',\n        additionalInfo: JSON.stringify(additionalInfo),\n      })\n    );\n  },\n  cliFlowStepAnswered: ({\n    question,\n    questionKey,\n    answer,\n    additionalInfo,\n  }: {\n    question: string;\n    questionKey: string;\n    answer: string;\n    additionalInfo?: Record<string, unknown>;\n  }) => {\n    void biLogger.report(\n      wixCliAppFlowStepsAnswers({\n        questionKey,\n        question,\n        answer,\n        additionalInfo: JSON.stringify(additionalInfo),\n      })\n    );\n  },\n  fileUpload({\n    provider,\n    fileCount,\n    totalSizeInKb,\n    cliVersion,\n  }: {\n    provider: string;\n    fileCount: number;\n    totalSizeInKb: number;\n    cliVersion: string;\n  }) {\n    const startTimestamp = Date.now();\n\n    void biLogger.report(\n      wixCliAppFlowFileUploadStarted({\n        timestampMs: startTimestamp,\n        hostingProvider: provider,\n        numFiles: fileCount,\n        fileSizeCompressed: 0,\n        fileSizeNotCompressed: totalSizeInKb,\n        cliVersion,\n      })\n    );\n\n    return {\n      finished() {\n        void biLogger.report(\n          wixCliAppFlowUploadEnded({\n            duration: Date.now() - startTimestamp,\n          })\n        );\n      },\n    };\n  },\n  cliDeployment: ({\n    appId,\n    deploymentId,\n    files,\n  }: {\n    appId: string;\n    deploymentId: string;\n    files?: Array<{ filePath?: string; content?: string }>;\n  }) => {\n    const startTimestamp = Date.now();\n\n    const fileDetails = files\n      ? files\n          .filter((f) => f.filePath)\n          .map((file) => ({\n            filePath: file.filePath!,\n            fileSizeKb: file.content ? file.content.length / 1024 : 0,\n          }))\n      : [];\n\n    return {\n      finish: ({\n        isSuccess,\n        failureReason,\n      }: {\n        isSuccess: boolean;\n        failureReason?: string;\n      }) => {\n        void biLogger.report(\n          wixCliAppsFlowDeploymentStatusSrc11Evid5232({\n            isSuccess,\n            failureReason,\n            filesDetails: JSON.stringify(fileDetails),\n            filesSize: Math.round(\n              fileDetails.reduce((acc, { fileSizeKb }) => acc + fileSizeKb, 0)\n            ),\n            uploadSource: 'backend',\n            appId,\n            deploymentId,\n            filesUploadTime: Date.now() - startTimestamp,\n          })\n        );\n      },\n    };\n  },\n});\n","export { useWixCliAppBi } from './useWixCliAppBi.js';\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AAAA,mBAAwB;;;ACAxB;AASO,IAAM,oBAAoB,CAAC,cAAwB;AAAA,EACxD,WAAW,CAAC;AAAA,IACV;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,MAMM;AACJ,SAAK,SAAS;AAAA,MACZ,aAAa;AAAA,QACX;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA,gBAAgB,KAAK,UAAU,cAAc;AAAA,MAC/C,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EACA,aAAa,CAAC;AAAA,IACZ;AAAA,EACF,MAEM;AACJ,SAAK,SAAS;AAAA,MACZ,aAAa;AAAA,QACX,QAAQ;AAAA,QACR,KAAK;AAAA,QACL,gBAAgB,KAAK,UAAU,cAAc;AAAA,MAC/C,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EACA,qBAAqB,CAAC;AAAA,IACpB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,MAKM;AACJ,SAAK,SAAS;AAAA,MACZ,0BAA0B;AAAA,QACxB;AAAA,QACA;AAAA,QACA;AAAA,QACA,gBAAgB,KAAK,UAAU,cAAc;AAAA,MAC/C,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EACA,WAAW;AAAA,IACT;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,GAKG;AACD,UAAM,iBAAiB,KAAK,IAAI;AAEhC,SAAK,SAAS;AAAA,MACZ,+BAA+B;AAAA,QAC7B,aAAa;AAAA,QACb,iBAAiB;AAAA,QACjB,UAAU;AAAA,QACV,oBAAoB;AAAA,QACpB,uBAAuB;AAAA,QACvB;AAAA,MACF,CAAC;AAAA,IACH;AAEA,WAAO;AAAA,MACL,WAAW;AACT,aAAK,SAAS;AAAA,UACZ,yBAAyB;AAAA,YACvB,UAAU,KAAK,IAAI,IAAI;AAAA,UACzB,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACA,eAAe,CAAC;AAAA,IACd;AAAA,IACA;AAAA,IACA;AAAA,EACF,MAIM;AACJ,UAAM,iBAAiB,KAAK,IAAI;AAEhC,UAAM,cAAc,QAChB,MACG,OAAO,CAAC,MAAM,EAAE,QAAQ,EACxB,IAAI,CAAC,UAAU;AAAA,MACd,UAAU,KAAK;AAAA,MACf,YAAY,KAAK,UAAU,KAAK,QAAQ,SAAS,OAAO;AAAA,IAC1D,EAAE,IACJ,CAAC;AAEL,WAAO;AAAA,MACL,QAAQ,CAAC;AAAA,QACP;AAAA,QACA;AAAA,MACF,MAGM;AACJ,aAAK,SAAS;AAAA,UACZ,4CAA4C;AAAA,YAC1C;AAAA,YACA;AAAA,YACA,cAAc,KAAK,UAAU,WAAW;AAAA,YACxC,WAAW,KAAK;AAAA,cACd,YAAY,OAAO,CAAC,KAAK,EAAE,WAAW,MAAM,MAAM,YAAY,CAAC;AAAA,YACjE;AAAA,YACA,cAAc;AAAA,YACd;AAAA,YACA;AAAA,YACA,iBAAiB,KAAK,IAAI,IAAI;AAAA,UAChC,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;;;AD7IO,SAAS,iBAAiB;AAC/B,QAAM,WAAW,YAAY;AAC7B,aAAO,sBAAQ,MAAM,kBAAkB,QAAQ,GAAG,CAAC,QAAQ,CAAC;AAC9D;;;AEPA;","names":[]}